<transformation>
  <info>
    <name>ID_Kreditcepat.External_DC_SubmitCases</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
      <slaveserver>
        <name>Pentaho Carte</name>
        <hostname>http&#x3a;&#x2f;&#x2f;10.10.99.8</hostname>
        <port>8080</port>
        <webAppName>Carte</webAppName>
        <username>jurisrr</username>
<password>Encrypted 6acaecdff24588c3d4e548fe3e87cbe182</password>        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>      </slaveserver>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018&#x2f;06&#x2f;04 18&#x3a;05&#x3a;19.634</created_date>
    <modified_user>-</modified_user>
    <modified_date>2018&#x2f;06&#x2f;06 17&#x3a;00&#x3a;38.893</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>Push id, open total, start and end date to WH</note>
      <xloc>224</xloc>
      <yloc>240</yloc>
      <width>247</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>Indonesia</name>
    <server>35.194.247.194</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>indonesia_prod</database>
    <port>5432</port>
    <username>jurisr</username>
    <password>Encrypted 50686f4f69426f7a4830494d38326d56fcc0c3f0129ebcafa7349c74e7cba7cb</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5432</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>WHS Kreditcepat</name>
    <server>10.10.99.11</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>kreditcepat</database>
    <port>5432</port>
    <username>jurisrr</username>
    <password>Encrypted 2be98afc86aa7c481e631a16affc1f0ed</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5432</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>get the list</from>
      <to>write to WHS</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>get the list</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Indonesia</connection>
    <sql>-- &#x23;&#x23; Extract data on loan level including credit info, client, application data&#xd;&#xa;&#xd;&#xa;--&#x23;&#x23; aggregation of payments_distr table on loan level&#xd;&#xa;with dd as &#x28;select d.loan_id,&#xd;&#xa;sum&#x28;d.cash_in&#x29; as amount, sum&#x28;d.principal_disbursed&#x29; as amount_principal, &#xd;&#xa;       sum&#x28;d.interest_paid&#x29; as amount_commission, sum&#x28;d.penalty_paid&#x29; as amount_penalty, sum&#x28;d.overpayment_received&#x29; - sum&#x28;d.overpayment_refunded&#x29; as amount_surplus&#xd;&#xa;	from &#xd;&#xa;transaction.transaction d  &#xd;&#xa;where 1&#x3d;1 &#xd;&#xa;	--and p.cl_bank_acct_id &#x3c;&#x3e; 11&#xd;&#xa;group by d.loan_id&#x29;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- fees separately&#x21; as extensions ar in fees&#xd;&#xa;&#xd;&#xa;,pay as &#x28;select loan_id, min&#x28;booking_date&#x29;&#x3a;&#x3a;date as first_payment_date , max&#x28;booking_date&#x29;&#x3a;&#x3a;date as last_payment_date&#xd;&#xa;	,sum&#x28;cash_in&#x29; as paid_so_far&#xd;&#xa;	from transaction.transaction &#xd;&#xa;		where transaction_type in &#x28;&#x27;REPAYMENT&#x27;,&#x27;PAYMENT&#x27;&#x29; &#xd;&#xa;		group by loan_id&#x29;&#xd;&#xa;&#xd;&#xa;,pay_dc as &#x28;select loan_id, min&#x28;booking_date&#x29;&#x3a;&#x3a;date as first_payment_date , max&#x28;booking_date&#x29;&#x3a;&#x3a;date as last_payment_date&#xd;&#xa;	,sum&#x28;cash_in&#x29; as paid_so_far&#xd;&#xa;	from transaction.transaction  &#xd;&#xa;		where transaction_type in &#x28;&#x27;REPAYMENT&#x27;,&#x27;PAYMENT&#x27;&#x29;   and booking_date&#x3a;&#x3a;date &#x3e; current_date&#xd;&#xa;		group by loan_id&#x29;&#xd;&#xa;&#xd;&#xa;,address as &#x28;select &#x2a; from &#xd;&#xa;		&#x28;select client_id, type, address_line1 as in_one_string,&#xd;&#xa;	rank&#x28;&#x29; over &#x28;partition by client_id, type order by client_id asc, type asc, id desc&#x29;as rrow&#xd;&#xa;	from crm.client_address &#x29;kk&#xd;&#xa;	where rrow &#x3d; 1&#x29;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;---&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;	&#xd;&#xa;&#xd;&#xa;SELECT &#xd;&#xa;&#xd;&#xa;l.id as loan_id&#xd;&#xa;--,&#x27;New Cases&#x27; as report_type&#xd;&#xa;, current_date as report_date   &#xd;&#xa;, current_date as dc_start -- this shouldn&#x27;t be updated&#xd;&#xa;, null&#x3a;&#x3a;date as dc_end&#xd;&#xa;&#xd;&#xa;-- need to add status correctly&#xd;&#xa;, case when  &#x28;l.principal_due &#x2b; l.interest_due &#x2b; l.penalty_due &#x2b; l.fee_due&#x29; &#x3d; 0  --&#x23;&#x23; added on 09.05.2017 as open&#x3d;0 were not put to STOP DC&#xd;&#xa;		then &#x27;STOP DC&#x27; &#xd;&#xa;	else&#xd;&#xa;  &#x27;START DC&#x27;  end as status_new  &#xd;&#xa;&#xd;&#xa;&#xd;&#xa;, l.loan_number as loan_no&#xd;&#xa;, l.issue_date&#x3a;&#x3a;date as loan_date&#xd;&#xa;--, l.term_date&#xd;&#xa;, l.principal_disbursed as loan_amount&#xd;&#xa;, l.interest_applied as loan_commission&#xd;&#xa;, l.period_count as term_days&#xd;&#xa;, current_date - l.maturity_date&#x3a;&#x3a;Date as current_delay&#xd;&#xa;, l.principal_due as open_principal&#xd;&#xa;, l.interest_due as open_commission&#xd;&#xa;--, l.amount_open_fees - lf.st_com as open_fees&#xd;&#xa;--, case when st_com &#x2b; coalesce&#x28;lf_pay,0&#x29; &#x3e;&#x3d;0 then coalesce&#x28;lf_fee,0&#x29;&#xd;&#xa;-- else st_com&#x2b;coalesce&#x28;lf_pay,0&#x29;&#x2b;coalesce&#x28;lf_fee,0&#x29; end as open_fees &#xd;&#xa;,l.fee_due as open_fees&#xd;&#xa;&#xd;&#xa;, l.penalty_due as open_penalty&#xd;&#xa;&#xd;&#xa;--, lf.st_com as standart_costs  -- &#x28;CASE WHEN substring&#x28;lo.loan_no from &#x27;..&#x24;&#x27;&#x29;&#x3a;&#x3a;numeric&#x3d;1 THEN coalesce&#x28;&#x28;select sum&#x28;lf.amount&#x29; &#xd;&#xa;							--from r_loan_fee lf where lf.r_loan_id&#x3d;lo.r_loan_id and lf.type&#x3d;&#x27;Standard commission&#x27;&#x29;&#x3a;&#x3a;decimal,0&#x29; ELSE 0 END&#x29; Standart_Costs&#xd;&#xa;&#xd;&#xa;--, case when st_com &#x2b; coalesce&#x28;lf_pay,0&#x29;&#x3c;0 then 0 else st_com &#x2b; coalesce&#x28;lf_pay,0&#x29; end as standard_costs  -- added in order to separate loan fee from standard commission 19.04.2017.&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--compare the fees&#x3f;&#xd;&#xa;&#xd;&#xa;,l.extensions as taken_extensions&#xd;&#xa;,pay.paid_so_far as paid_so_far_new&#xd;&#xa;&#xd;&#xa;, l.principal_due &#x2b; l.interest_due &#x2b; l.penalty_due &#x2b; l.fee_due as open_total --done&#xd;&#xa;&#xd;&#xa;,pay_dc.paid_so_far as  paid_after_external_dc_started&#xd;&#xa;--,tt.last_task_comment&#xd;&#xa;--,tt.last_task_status&#xd;&#xa;--,tt.resolution&#xd;&#xa;,cpi.first_name as client_name&#xd;&#xa;,cpi.last_name as client_surname&#xd;&#xa;--,cpi.nin as pesel&#xd;&#xa;,id.number as id_doc_no&#xd;&#xa;,phcon.local_number as client_phone_no&#xd;&#xa;,ec.email as client_email&#xd;&#xa;--,c.home_phone as client_homephone_no&#xd;&#xa;--,c.notes&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;,ad.in_one_string as client_actual&#xd;&#xa;&#xd;&#xa;--,c.workplace_title as client_workplace&#xd;&#xa;--,c.workplace_address as client_work_address&#xd;&#xa;--,c.workplace_phone as client_work_phone&#xd;&#xa;--,c.contact_person as contact_person_name&#xd;&#xa;--,c.contact_person_phone as contact_person_phone&#xd;&#xa;&#xd;&#xa;,bc.account_number as person_bankaccount_no&#xd;&#xa;&#xd;&#xa;--&#x23;&#x23;&#x23;&#x23; employment data&#xd;&#xa;&#xd;&#xa;,ed.json_value&#x3a;&#x3a;json-&#x3e;&#x3e;&#x27;employersName&#x27; as employersName&#xd;&#xa;,ed.json_value&#x3a;&#x3a;json-&#x3e;&#x3e;&#x27;employersAddress&#x27; as employersAddress&#xd;&#xa;,ed.json_value&#x3a;&#x3a;json-&#x3e;&#x3e;&#x27;officePhone&#x27; as officePhone&#xd;&#xa;,ed.json_value&#x3a;&#x3a;json-&#x3e;&#x3e;&#x27;jobPosition&#x27; as jobPosition&#xd;&#xa;&#xd;&#xa;--&#x23;&#x23;&#x23;&#x23; employment data&#xd;&#xa;&#xd;&#xa;--,tra.cash_in&#xd;&#xa;--,tra.booking_date&#xd;&#xa;&#xd;&#xa;--, case when &#x28;current_date - &#x3f; &#x29;  &#x3e; 70 then  &#x27;STOP DC&#x27;	&#xd;&#xa;--		else null end as status_stop -- fixed on 11.04.2017 &#x3e;70 instead of &#x3e;100&#xd;&#xa;&#xd;&#xa;,&#x28;select resolution from task.task where loan_id &#x3d; l.id order by id desc limit 1&#x29; as last_task_resolution&#xd;&#xa;&#xd;&#xa;--&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;  FROM lending.loan l   &#xd;&#xa;		join crm.client c on &#x28;l.client_id &#x3d; c.id&#x29; &#xd;&#xa;		join crm.personal_info cpi on &#x28;l.client_id &#x3d; cpi.client_id&#x29;&#xd;&#xa;		join crm.identity_document id on &#x28;l.client_id &#x3d; id.client_id and id.is_primary &#x3d; TRUE&#x29;&#xd;&#xa;	left outer join crm.phone_contact phcon on &#x28;phcon.client_id&#x3d;l.client_id and phcon.is_primary &#x3d; TRUE and phcon.phone_type &#x3d; 0&#x29;&#xd;&#xa;	left outer join crm.email_contact ec on &#x28;ec.client_id&#x3d;l.client_id and ec.is_primary &#x3d; TRUE &#x29;&#xd;&#xa;	left outer join crm.client_bank_account bc on &#x28;bc.client_id&#x3d;l.client_id and bc.is_primary &#x3d; TRUE &#x29;&#xd;&#xa;		--left outer join r_client_address ad on &#x28;c.act_client_address_id &#x3d; ad.r_client_address_id&#x29; &#xd;&#xa;		--left outer join r_client_address ad1 on &#x28;c.decl_client_address_id &#x3d; ad.r_client_address_id&#x29; &#xd;&#xa;	left outer join dd dd on &#x28;dd.loan_id &#x3d; l.id&#x29;  --done&#xd;&#xa;	left outer join pay pay on &#x28;pay.loan_id &#x3d; l.id&#x29;&#xd;&#xa;	left outer join pay_dc pay_dc on &#x28;pay_dc.loan_id &#x3d; l.id&#x29;&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;	--join out out on &#x28;l.id &#x3d; out.loan_id&#x29; &#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	left outer join &#x28;select ct.loan_id, ct.comment as last_task_comment, ct.resolution , ct.status as last_task_status  from &#x28;SELECT loan_id, max&#x28;id&#x29; as max_id&#xd;&#xa; 					 FROM task.task&#xd;&#xa;						group by loan_id&#x29;aa join task.task ct on &#x28; ct.id&#x3d;aa.max_id&#x29; &#xd;&#xa;						order by ct.id desc&#xd;&#xa;						limit 1&#x29;tt on &#x28;l.id&#x3d;tt.loan_id&#x29;&#xd;&#xa;&#xd;&#xa;	left outer join &#x28;select  tr.loan_id, trr.cash_in, trr.booking_date&#x3a;&#x3a;date from &#x28;SELECT loan_id, max&#x28;id&#x29; as max_id&#xd;&#xa; 					 FROM transaction.transaction where transaction_type in &#x28;&#x27;REPAYMENT&#x27;,&#x27;PAYMENT&#x27;&#x29; &#xd;&#xa;						group by loan_id&#x29;tr join transaction.transaction trr on &#x28; trr.id&#x3d;tr.max_id&#x29; &#xd;&#xa;						order by trr.id desc&#xd;&#xa;						limit 1&#x29;tra on &#x28;l.id&#x3d;tra.loan_id&#x29;&#xd;&#xa;						&#xd;&#xa;	left outer join address ad on &#x28;c.id &#x3d; ad.client_id and ad.type &#x3d; &#x27;ACTUAL&#x27;&#x29;  --done&#xd;&#xa;	left outer join address ad1 on &#x28;c.id &#x3d; ad1.client_id and ad1.type &#x3d; &#x27;DECLARED&#x27;&#x29; --done&#xd;&#xa;&#xd;&#xa;	left outer join crm.client_attribute pd on &#x28;pd.client_id &#x3d; c.id and pd.key &#x3d; &#x27;personalData&#x27;&#x29;&#xd;&#xa;	left outer join crm.client_attribute ed on &#x28;ed.client_id &#x3d; c.id and ed.key &#x3d; &#x27;employmentData&#x27;&#x29;&#xd;&#xa;	left outer join crm.client_attribute bd on &#x28;bd.client_id &#x3d; c.id and bd.key &#x3d; &#x27;bankAndTermsData&#x27;&#x29;&#xd;&#xa;	left outer join crm.client_attribute add on &#x28;add.client_id &#x3d; c.id and add.key &#x3d; &#x27;addressData&#x27;&#x29;&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;	left outer join &#x28;select loan_id, sum&#x28;fee_paid&#x29; as st_com from transaction.transaction where transaction_sub_type &#x3d; &#x27;STANDARD_COMMISSION&#x27; group by loan_id&#x29;lf on &#x28;lf.loan_id &#x3d; l.id&#x29; --done&#xd;&#xa;	left outer join &#x28;select loan_id, sum&#x28;fee_paid&#x29; as lf_fee from transaction.transaction where transaction_sub_type in &#x28;&#x27;LETTER&#x27;, &#x27;VOICE_SMS&#x27;&#x29; group by loan_id&#x29;lff on &#x28;lff.loan_id &#x3d; l.id&#x29; --done&#xd;&#xa;	left outer join &#x28;select loan_id, sum&#x28;fee_paid&#x29; as lf_pay from transaction.transaction where transaction_sub_type in &#x28;&#x27;OTHER&#x27;, &#x27;LATE_FEE&#x27;&#x29; group by loan_id&#x29;lfp on &#x28;lfp.loan_id &#x3d; l.id&#x29; --done&#xd;&#xa;	&#xd;&#xa;where 1&#x3d;1&#xd;&#xa;&#xd;&#xa;and l.status &#x3d; &#x27;ACTIVE&#x27;&#xd;&#xa;&#xd;&#xa;--and  &#x28;current_date - l.maturity_date&#x3a;&#x3a;date &#x29;  &#x3e;&#x3d; 31&#xd;&#xa;&#xd;&#xa;and c.id in &#x28;59229,&#xd;&#xa;28296,&#xd;&#xa;27155,&#xd;&#xa;8249,&#xd;&#xa;79446,&#xd;&#xa;80931,&#xd;&#xa;89189,&#xd;&#xa;58107,&#xd;&#xa;40315,&#xd;&#xa;56685,&#xd;&#xa;74783,&#xd;&#xa;76706,&#xd;&#xa;70942,&#xd;&#xa;7187,&#xd;&#xa;22611,&#xd;&#xa;73374,&#xd;&#xa;55109,&#xd;&#xa;74018,&#xd;&#xa;68967,&#xd;&#xa;58866,&#xd;&#xa;74729,&#xd;&#xa;72439,&#xd;&#xa;22315,&#xd;&#xa;16898,&#xd;&#xa;71939,&#xd;&#xa;71431,&#xd;&#xa;68649,&#xd;&#xa;65912,&#xd;&#xa;69996,&#xd;&#xa;80443,&#xd;&#xa;14865,&#xd;&#xa;73688,&#xd;&#xa;14426,&#xd;&#xa;47135,&#xd;&#xa;67119,&#xd;&#xa;71985,&#xd;&#xa;28360,&#xd;&#xa;60264,&#xd;&#xa;25883,&#xd;&#xa;12969,&#xd;&#xa;9470,&#xd;&#xa;64823,&#xd;&#xa;38629,&#xd;&#xa;5363,&#xd;&#xa;5974,&#xd;&#xa;10840,&#xd;&#xa;37934,&#xd;&#xa;55,&#xd;&#xa;7102,&#xd;&#xa;17436,&#xd;&#xa;13452,&#xd;&#xa;49673,&#xd;&#xa;41875,&#xd;&#xa;45715,&#xd;&#xa;39579,&#xd;&#xa;25550,&#xd;&#xa;40286,&#xd;&#xa;26443,&#xd;&#xa;48615,&#xd;&#xa;40701,&#xd;&#xa;70435,&#xd;&#xa;71723,&#xd;&#xa;71609,&#xd;&#xa;48567,&#xd;&#xa;6675,&#xd;&#xa;67897,&#xd;&#xa;68928,&#xd;&#xa;55641,&#xd;&#xa;42012,&#xd;&#xa;46725,&#xd;&#xa;69603,&#xd;&#xa;62614,&#xd;&#xa;68433,&#xd;&#xa;5296,&#xd;&#xa;69436,&#xd;&#xa;38169,&#xd;&#xa;530,&#xd;&#xa;65928,&#xd;&#xa;33801,&#xd;&#xa;18154,&#xd;&#xa;45480,&#xd;&#xa;43066,&#xd;&#xa;7258,&#xd;&#xa;41748,&#xd;&#xa;14538,&#xd;&#xa;39117,&#xd;&#xa;50104,&#xd;&#xa;60074,&#xd;&#xa;33199,&#xd;&#xa;63185,&#xd;&#xa;38841,&#xd;&#xa;19879,&#xd;&#xa;59729,&#xd;&#xa;21043,&#xd;&#xa;61655,&#xd;&#xa;5113,&#xd;&#xa;61564,&#xd;&#xa;56692,&#xd;&#xa;62227,&#xd;&#xa;59330,&#xd;&#xa;16149,&#xd;&#xa;24313,&#xd;&#xa;57237,&#xd;&#xa;26521,&#xd;&#xa;60152,&#xd;&#xa;27028,&#xd;&#xa;29967,&#xd;&#xa;56658,&#xd;&#xa;56566,&#xd;&#xa;38783,&#xd;&#xa;17942,&#xd;&#xa;53437,&#xd;&#xa;37437,&#xd;&#xa;47364,&#xd;&#xa;57587,&#xd;&#xa;38637,&#xd;&#xa;57266,&#xd;&#xa;58283,&#xd;&#xa;57362,&#xd;&#xa;51864,&#xd;&#xa;861,&#xd;&#xa;34509,&#xd;&#xa;24412,&#xd;&#xa;8164,&#xd;&#xa;35241,&#xd;&#xa;35841,&#xd;&#xa;18148,&#xd;&#xa;35761,&#xd;&#xa;26067,&#xd;&#xa;54056,&#xd;&#xa;50977,&#xd;&#xa;41318,&#xd;&#xa;52220,&#xd;&#xa;52228,&#xd;&#xa;50652,&#xd;&#xa;49942,&#xd;&#xa;9207,&#xd;&#xa;1996,&#xd;&#xa;48501,&#xd;&#xa;26473,&#xd;&#xa;50103,&#xd;&#xa;51795,&#xd;&#xa;49696,&#xd;&#xa;50912,&#xd;&#xa;48200,&#xd;&#xa;29073,&#xd;&#xa;31271,&#xd;&#xa;7461,&#xd;&#xa;19010,&#xd;&#xa;33101,&#xd;&#xa;30188,&#xd;&#xa;46029,&#xd;&#xa;38971,&#xd;&#xa;4784,&#xd;&#xa;42251,&#xd;&#xa;3539,&#xd;&#xa;1914,&#xd;&#xa;46994,&#xd;&#xa;47406,&#xd;&#xa;2322,&#xd;&#xa;27061,&#xd;&#xa;30612,&#xd;&#xa;43948,&#xd;&#xa;44313,&#xd;&#xa;25450,&#xd;&#xa;41825,&#xd;&#xa;42346,&#xd;&#xa;44264,&#xd;&#xa;45128,&#xd;&#xa;12841,&#xd;&#xa;30806,&#xd;&#xa;45658,&#xd;&#xa;40858,&#xd;&#xa;44690,&#xd;&#xa;6058,&#xd;&#xa;1015,&#xd;&#xa;46642,&#xd;&#xa;39188,&#xd;&#xa;31228,&#xd;&#xa;35897,&#xd;&#xa;37066,&#xd;&#xa;44466,&#xd;&#xa;20277,&#xd;&#xa;42637,&#xd;&#xa;42409,&#xd;&#xa;44976,&#xd;&#xa;40653,&#xd;&#xa;37297,&#xd;&#xa;36219,&#xd;&#xa;5410,&#xd;&#xa;3400,&#xd;&#xa;18226,&#xd;&#xa;21445,&#xd;&#xa;16463,&#xd;&#xa;4722,&#xd;&#xa;15253,&#xd;&#xa;5250,&#xd;&#xa;40185,&#xd;&#xa;7196,&#xd;&#xa;27291,&#xd;&#xa;35959,&#xd;&#xa;35846,&#xd;&#xa;37360,&#xd;&#xa;6968,&#xd;&#xa;6091,&#xd;&#xa;14315,&#xd;&#xa;25984,&#xd;&#xa;10412,&#xd;&#xa;30807,&#xd;&#xa;23879,&#xd;&#xa;25608,&#xd;&#xa;17469,&#xd;&#xa;6547,&#xd;&#xa;38724,&#xd;&#xa;37228,&#xd;&#xa;30115,&#xd;&#xa;22205,&#xd;&#xa;28035,&#xd;&#xa;31126,&#xd;&#xa;31869,&#xd;&#xa;6533,&#xd;&#xa;5611,&#xd;&#xa;6286,&#xd;&#xa;16974,&#xd;&#xa;23659,&#xd;&#xa;27417,&#xd;&#xa;35700,&#xd;&#xa;38368,&#xd;&#xa;14480,&#xd;&#xa;6523,&#xd;&#xa;18511,&#xd;&#xa;27988,&#xd;&#xa;5583,&#xd;&#xa;7620,&#xd;&#xa;5703,&#xd;&#xa;24745,&#xd;&#xa;5270,&#xd;&#xa;59,&#xd;&#xa;19153,&#xd;&#xa;29375,&#xd;&#xa;5015,&#xd;&#xa;31616,&#xd;&#xa;17108,&#xd;&#xa;30120,&#xd;&#xa;11866,&#xd;&#xa;30342,&#xd;&#xa;9108,&#xd;&#xa;25817,&#xd;&#xa;25999,&#xd;&#xa;12664,&#xd;&#xa;28380,&#xd;&#xa;1224,&#xd;&#xa;6942,&#xd;&#xa;18676,&#xd;&#xa;23281,&#xd;&#xa;469,&#xd;&#xa;14926,&#xd;&#xa;26320,&#xd;&#xa;25721,&#xd;&#xa;17262,&#xd;&#xa;20614,&#xd;&#xa;5278,&#xd;&#xa;23832,&#xd;&#xa;20815,&#xd;&#xa;23028,&#xd;&#xa;919,&#xd;&#xa;26395,&#xd;&#xa;7130,&#xd;&#xa;9579,&#xd;&#xa;17252,&#xd;&#xa;28059,&#xd;&#xa;27253,&#xd;&#xa;14414,&#xd;&#xa;23873,&#xd;&#xa;23739,&#xd;&#xa;9456,&#xd;&#xa;20040,&#xd;&#xa;26138,&#xd;&#xa;6631,&#xd;&#xa;19562,&#xd;&#xa;14386,&#xd;&#xa;15038,&#xd;&#xa;23616,&#xd;&#xa;5044,&#xd;&#xa;18041,&#xd;&#xa;5086,&#xd;&#xa;14388,&#xd;&#xa;21534,&#xd;&#xa;14469,&#xd;&#xa;10861,&#xd;&#xa;12544,&#xd;&#xa;9389,&#xd;&#xa;9464,&#xd;&#xa;6546,&#xd;&#xa;14872,&#xd;&#xa;17100,&#xd;&#xa;10752,&#xd;&#xa;20733,&#xd;&#xa;7460,&#xd;&#xa;16785,&#xd;&#xa;9127,&#xd;&#xa;6764,&#xd;&#xa;9351,&#xd;&#xa;23209,&#xd;&#xa;18776,&#xd;&#xa;10442,&#xd;&#xa;8557,&#xd;&#xa;6349,&#xd;&#xa;5114,&#xd;&#xa;8272,&#xd;&#xa;7311,&#xd;&#xa;6413,&#xd;&#xa;20756,&#xd;&#xa;2873,&#xd;&#xa;20301,&#xd;&#xa;14913,&#xd;&#xa;6025,&#xd;&#xa;21328,&#xd;&#xa;16217,&#xd;&#xa;20891,&#xd;&#xa;13046,&#xd;&#xa;15822,&#xd;&#xa;6596,&#xd;&#xa;12686,&#xd;&#xa;16938,&#xd;&#xa;6809,&#xd;&#xa;5335,&#xd;&#xa;17871,&#xd;&#xa;5350,&#xd;&#xa;3922,&#xd;&#xa;7504,&#xd;&#xa;857,&#xd;&#xa;5595,&#xd;&#xa;6102,&#xd;&#xa;805,&#xd;&#xa;13940,&#xd;&#xa;787,&#xd;&#xa;4978,&#xd;&#xa;7020,&#xd;&#xa;7064,&#xd;&#xa;1507,&#xd;&#xa;10025,&#xd;&#xa;9175,&#xd;&#xa;3867,&#xd;&#xa;1691,&#xd;&#xa;6777,&#xd;&#xa;4936,&#xd;&#xa;8953,&#xd;&#xa;6716,&#xd;&#xa;6432,&#xd;&#xa;5800,&#xd;&#xa;5265,&#xd;&#xa;4468,&#xd;&#xa;5437,&#xd;&#xa;5795,&#xd;&#xa;1437,&#xd;&#xa;5438,&#xd;&#xa;4392,&#xd;&#xa;2336,&#xd;&#xa;5228,&#xd;&#xa;6725,&#xd;&#xa;6448,&#xd;&#xa;5861,&#xd;&#xa;4282,&#xd;&#xa;1078,&#xd;&#xa;2967,&#xd;&#xa;5161,&#xd;&#xa;1758,&#xd;&#xa;5319,&#xd;&#xa;4358,&#xd;&#xa;2470,&#xd;&#xa;4658,&#xd;&#xa;4948,&#xd;&#xa;4625,&#xd;&#xa;4830,&#xd;&#xa;4514,&#xd;&#xa;2497,&#xd;&#xa;537,&#xd;&#xa;3100,&#xd;&#xa;2672,&#xd;&#xa;2811,&#xd;&#xa;2898,&#xd;&#xa;946,&#xd;&#xa;2607,&#xd;&#xa;1721,&#xd;&#xa;2678,&#xd;&#xa;1146,&#xd;&#xa;1589,&#xd;&#xa;2875,&#xd;&#xa;1561,&#xd;&#xa;1893,&#xd;&#xa;427,&#xd;&#xa;257,&#xd;&#xa;2136,&#xd;&#xa;452,&#xd;&#xa;29,&#xd;&#xa;958,&#xd;&#xa;882,&#xd;&#xa;40,&#xd;&#xa;952&#x29; &#xd;&#xa;&#xd;&#xa;order by l.loan_number asc&#xd;&#xa;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>write to WHS</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>WHS Kreditcepat</connection>
    <schema/>
    <table>external_dc_submit_cases</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>loan_id</column_name>
          <stream_name>loan_id</stream_name>
        </field>
        <field>
          <column_name>report_date</column_name>
          <stream_name>report_date</stream_name>
        </field>
        <field>
          <column_name>dc_start</column_name>
          <stream_name>dc_start</stream_name>
        </field>
        <field>
          <column_name>dc_end</column_name>
          <stream_name>dc_end</stream_name>
        </field>
        <field>
          <column_name>status_new</column_name>
          <stream_name>status_new</stream_name>
        </field>
        <field>
          <column_name>loan_no</column_name>
          <stream_name>loan_no</stream_name>
        </field>
        <field>
          <column_name>loan_date</column_name>
          <stream_name>loan_date</stream_name>
        </field>
        <field>
          <column_name>loan_amount</column_name>
          <stream_name>loan_amount</stream_name>
        </field>
        <field>
          <column_name>loan_commission</column_name>
          <stream_name>loan_commission</stream_name>
        </field>
        <field>
          <column_name>term_days</column_name>
          <stream_name>term_days</stream_name>
        </field>
        <field>
          <column_name>current_delay</column_name>
          <stream_name>current_delay</stream_name>
        </field>
        <field>
          <column_name>open_principal</column_name>
          <stream_name>open_principal</stream_name>
        </field>
        <field>
          <column_name>open_commission</column_name>
          <stream_name>open_commission</stream_name>
        </field>
        <field>
          <column_name>open_fees</column_name>
          <stream_name>open_fees</stream_name>
        </field>
        <field>
          <column_name>open_penalty</column_name>
          <stream_name>open_penalty</stream_name>
        </field>
        <field>
          <column_name>taken_extensions</column_name>
          <stream_name>taken_extensions</stream_name>
        </field>
        <field>
          <column_name>paid_so_far_new</column_name>
          <stream_name>paid_so_far_new</stream_name>
        </field>
        <field>
          <column_name>open_total</column_name>
          <stream_name>open_total</stream_name>
        </field>
        <field>
          <column_name>paid_after_external_dc_started</column_name>
          <stream_name>paid_after_external_dc_started</stream_name>
        </field>
        <field>
          <column_name>client_name</column_name>
          <stream_name>client_name</stream_name>
        </field>
        <field>
          <column_name>client_surname</column_name>
          <stream_name>client_surname</stream_name>
        </field>
        <field>
          <column_name>id_doc_no</column_name>
          <stream_name>id_doc_no</stream_name>
        </field>
        <field>
          <column_name>client_phone_no</column_name>
          <stream_name>client_phone_no</stream_name>
        </field>
        <field>
          <column_name>client_email</column_name>
          <stream_name>client_email</stream_name>
        </field>
        <field>
          <column_name>client_actual</column_name>
          <stream_name>client_actual</stream_name>
        </field>
        <field>
          <column_name>person_bankaccount_no</column_name>
          <stream_name>person_bankaccount_no</stream_name>
        </field>
        <field>
          <column_name>employersname</column_name>
          <stream_name>employersname</stream_name>
        </field>
        <field>
          <column_name>employersaddress</column_name>
          <stream_name>employersaddress</stream_name>
        </field>
        <field>
          <column_name>officephone</column_name>
          <stream_name>officephone</stream_name>
        </field>
        <field>
          <column_name>jobposition</column_name>
          <stream_name>jobposition</stream_name>
        </field>
        <field>
          <column_name>last_task_resolution</column_name>
          <stream_name>last_task_resolution</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>write to WH reporting</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>WHS Kreditcepat</connection>
    <schema/>
    <table>external_dc_submit_cases</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>loan_id</column_name>
          <stream_name>loan_id</stream_name>
        </field>
        <field>
          <column_name>report_date</column_name>
          <stream_name>report_date</stream_name>
        </field>
        <field>
          <column_name>dc_start</column_name>
          <stream_name>dc_start</stream_name>
        </field>
        <field>
          <column_name>dc_end</column_name>
          <stream_name>dc_end</stream_name>
        </field>
        <field>
          <column_name>status_new</column_name>
          <stream_name>status_new</stream_name>
        </field>
        <field>
          <column_name>loan_no</column_name>
          <stream_name>loan_no</stream_name>
        </field>
        <field>
          <column_name>loan_date</column_name>
          <stream_name>loan_date</stream_name>
        </field>
        <field>
          <column_name>loan_amount</column_name>
          <stream_name>loan_amount</stream_name>
        </field>
        <field>
          <column_name>loan_commission</column_name>
          <stream_name>loan_commission</stream_name>
        </field>
        <field>
          <column_name>term_days</column_name>
          <stream_name>term_days</stream_name>
        </field>
        <field>
          <column_name>current_delay</column_name>
          <stream_name>current_delay</stream_name>
        </field>
        <field>
          <column_name>open_principal</column_name>
          <stream_name>open_principal</stream_name>
        </field>
        <field>
          <column_name>open_commission</column_name>
          <stream_name>open_commission</stream_name>
        </field>
        <field>
          <column_name>open_fees</column_name>
          <stream_name>open_fees</stream_name>
        </field>
        <field>
          <column_name>open_penalty</column_name>
          <stream_name>open_penalty</stream_name>
        </field>
        <field>
          <column_name>taken_extensions</column_name>
          <stream_name>taken_extensions</stream_name>
        </field>
        <field>
          <column_name>paid_so_far_new</column_name>
          <stream_name>paid_so_far_new</stream_name>
        </field>
        <field>
          <column_name>open_total</column_name>
          <stream_name>open_total</stream_name>
        </field>
        <field>
          <column_name>paid_after_external_dc_started</column_name>
          <stream_name>paid_after_external_dc_started</stream_name>
        </field>
        <field>
          <column_name>client_name</column_name>
          <stream_name>client_name</stream_name>
        </field>
        <field>
          <column_name>client_surname</column_name>
          <stream_name>client_surname</stream_name>
        </field>
        <field>
          <column_name>id_doc_no</column_name>
          <stream_name>id_doc_no</stream_name>
        </field>
        <field>
          <column_name>client_phone_no</column_name>
          <stream_name>client_phone_no</stream_name>
        </field>
        <field>
          <column_name>client_email</column_name>
          <stream_name>client_email</stream_name>
        </field>
        <field>
          <column_name>client_actual</column_name>
          <stream_name>client_actual</stream_name>
        </field>
        <field>
          <column_name>person_bankaccount_no</column_name>
          <stream_name>person_bankaccount_no</stream_name>
        </field>
        <field>
          <column_name>employersname</column_name>
          <stream_name>employersname</stream_name>
        </field>
        <field>
          <column_name>employersaddress</column_name>
          <stream_name>employersaddress</stream_name>
        </field>
        <field>
          <column_name>officephone</column_name>
          <stream_name>officephone</stream_name>
        </field>
        <field>
          <column_name>jobposition</column_name>
          <stream_name>jobposition</stream_name>
        </field>
        <field>
          <column_name>last_task_resolution</column_name>
          <stream_name>last_task_resolution</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
